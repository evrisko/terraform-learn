# set hostname
sudo hostnamectl set-hostname ansible-master

# install ansible
yum -y install python-pip
pip install ansible
ansible --version

#Create ansible config file
mkdir ansible
cd ansible
touch ansible.cfg hosts

cat ansible.cfg
[defaults]
host_key_checking          = false
inventory                  = ./hosts
interpreter_python         = auto_legacy_silent

[ec2-user@ansible-master ansible]$ cat hosts
[stage]
172.31.47.153     ansible_hosts=172.31.47.153
172.31.44.235     ansible_hosts=172.31.44.235

[stage:vars]
ansible_ssh_private_key_file=/home/ec2-user/.ssh/ansible-client-key.pem

[prod]
ip-172-31-35-7.eu-central-1.compute.internal    ansible_hosts=172.31.35.7
ip-172-31-39-254.eu-central-1.compute.internal  ansible_hosts=172.31.39.254

[prod:vars]
ansible_ssh_private_key_file=/home/ec2-user/.ssh/ansible-client-key2.pem

[all_ec2:children]
stage
prod

[all_ec2:vars]
ansible_users=ec2-user

# ad-hoc commamd

ansible all -m ping
ansible stage -m setup
ansible stage -m shell -a "uptime"
ansible all -m command -a "uname -a"
ansible prod -m shell -a "free -m"
